# -*- mode: ruby -*-
# vi: set ft=ruby :

Vagrant.configure("2") do |config|
  config.vm.box = "bento/debian-11"

  config.vm.provider "virtualbox" do |vb|
    vb.gui = true
    vb.memory = "2048"
	  vb.cpus = 2
  end

  config.vm.synced_folder ".", "/vagrant"

  config.vm.provision "shell", inline: <<-SHELL
	apt-get update && apt-get install -y  xfce4 firefox-esr vim
	# docker
	curl -fsSL https://get.docker.com -o get-docker.sh
	sh get-docker.sh
	# kubectl
	curl -LO "https://dl.k8s.io/release/$(curl -L -s https://dl.k8s.io/release/stable.txt)/bin/linux/amd64/kubectl"
	install -o root -g root -m 0755 kubectl /usr/local/bin/kubectl
	cat >> /home/vagrant/.bashrc << EOF
source <(kubectl completion bash)
alias k=kubectl
complete -o default -F __start_kubectl k
EOF
	# k3d
	wget -q -O - https://raw.githubusercontent.com/k3d-io/k3d/main/install.sh | bash

  # argocd
	curl -sSL -o argocd-linux-amd64 https://github.com/argoproj/argo-cd/releases/latest/download/argocd-linux-amd64
	sudo install -m 555 argocd-linux-amd64 /usr/local/bin/argocd



	SHELL

end